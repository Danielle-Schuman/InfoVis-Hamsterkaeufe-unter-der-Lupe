<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Prototype</title>
    <style>
        body {
            background-color: #eeeeee
        }

        /*Axis*/
        .axisGray line{
            stroke: #777777;
        }

        .axisGray path{
            stroke: #777777;
        }

        .axisGray text{
            fill: #777777;
        }

        /*BUBBLES*/

        .bubbles {
            stroke-width: 2px;
            stroke: white;
        }
        .bubbles:hover {
            stroke: black;
        }



    </style>

</head>
<body>
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

<div id="my_prototype"></div>


<script>
    var margin = {top: 10, right: 20, bottom: 70, left: 70},
        width = 1200 - margin.left - margin.right,
        height = 600 - margin.top - margin.bottom;

    var svg = d3.select("#my_prototype")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform",
            "translate(" + margin.left + "," + margin.top + ")");

    //Hintergrund
    var background= svg.append("rect")
        .attr("id","backgroundRect")
        .attr("width","92.4%")
        .attr("height","86.9%")
        .attr("x",0)
        .attr("y",0)
        .attr("fill","#FFFFFF")

    //Linien des Koordinatensystems
    //In einer Schleife wäre das natürlich viel schöner. wird noch erledigt

    //BAUZONE
    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 101)
        .attr("y1", 0)
        .attr("x2", 101)
        .attr("y2", 520);

    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 202)
        .attr("y1", 0)
        .attr("x2", 202)
        .attr("y2", 520);

    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 303)
        .attr("y1", 0)
        .attr("x2", 303)
        .attr("y2", 520);

    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 404)
        .attr("y1", 0)
        .attr("x2", 404)
        .attr("y2", 520);

    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 505)
        .attr("y1", 0)
        .attr("x2", 505)
        .attr("y2", 520);


    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 606)
        .attr("y1", 0)
        .attr("x2", 606)
        .attr("y2", 520);

    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 707)
        .attr("y1", 0)
        .attr("x2", 707)
        .attr("y2", 520);

    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 808)
        .attr("y1", 0)
        .attr("x2", 808)
        .attr("y2", 520);

    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 909)
        .attr("y1", 0)
        .attr("x2", 909)
        .attr("y2", 520);

    svg.append('line')
        .style("stroke", "gray")
        .style("stroke-width", 1)
        .style("stroke-dasharray","5,5")
        .attr("x1", 1010)
        .attr("y1", 0)
        .attr("x2", 1010)
        .attr("y2", 520);

    //BAUZONE








    // Daten
    var data = [{x:20, y:700, z: 10, c: "Germany"}, {x:90, y:350, z: 10, c: "Brazil"}, {x:52, y:540, z: 10, c: "France"},
        {x:50, y:535, z: 10,  c: "South America"}, ]

    // x-Achse
    var x = d3.scaleLinear()
        .domain([0, 220])
        .range([ 0, width ]);
    svg.append("g")
        .attr("transform", "translate(0," + height + ")") //Axe unten
        .attr("class", "axisGray")
        .call(d3.axisBottom(x));

    // x-Achse Label:
    svg.append("text")
        .attr("text-anchor", "end")
        .attr("x", width - 500)
        .attr("y", height + margin.top + 40)
        .attr("font-weight", "bold")
        .attr("font-size", "12px")
        .attr("fill", "gray")
        .attr("font-family", "sans-serif")
        .text("7-Tage-Inzidenz-Wert");

    // y-Achse
    var y = d3.scaleLinear()
        .domain([0, 1000])
        .range([ height, 0]);
    svg.append("g")
        .attr("class", "axisGray")
        .call(d3.axisLeft(y));

    // y-Achse Label:
    svg.append("text")
        .attr("text-anchor", "end")
        .attr("transform", "rotate(-90)")
        .attr("y", -margin.left+20)
        .attr("x", -margin.top-160)
        .attr("font-weight", "bold")
        .attr("font-size", "12px")
        .attr("fill", "gray")
        .attr("font-family", "sans-serif")
        .text("Konsum (pro Kopf)")


    //Bubble-Göße
    var z = d3.scaleLinear()
        .domain([0, 50])
        .range([ 0, 60]);


    // Bubble-Farben und Eigenschaft
    var c= d3.scaleOrdinal()
        .domain(["Germany", "Brazil", "France", "South America"])
        .range(d3.schemeSet2);


    //Hover Funktion, um Name des Landes sehen zu können
    var tooltip = d3.select("#my_prototype")
        .append("div")
        .style("opacity", 0)
        .attr("class", "tooltip")
        .style("background-color", "black")
        .style("border-radius", "5px")
        .style("padding", "10px")
        .style("color", "white")

    var showTooltip = function(d) {
        tooltip
            .transition()
            .duration(200)
        tooltip
            .style("opacity", 1)
            .html("Country: " + d.c)
            .style("left", (d3.mouse(this)[0]+30) + "px")
            .style("top", (d3.mouse(this)[1]+30) + "px")
    }
    var moveTooltip = function(d) {
        tooltip
            .style("left", (d3.mouse(this)[0]+30) + "px")
            .style("top", (d3.mouse(this)[1]+30) + "px")
    }
    var hideTooltip = function(d) {
        tooltip
            .transition()
            .duration(200)
            .style("opacity", 0)
    }


    svg.append('g')
        .selectAll("dot")
        .data(data)
        .enter()
        .append("circle")
        .attr("cx", function (d) { return x(d.x); } )
        .attr("cy", function (d) { return y(d.y); } )
        .attr("r", function (d) { return z(d.z); } )
        .style("fill", function (d) { return c(d.c); } )
        .style("opacity", "0.7")
        .attr("stroke", "white")
        .style("stroke-width", "2px")
        .on("mouseover", showTooltip )
        .on("mousemove", moveTooltip )
        .on("mouseleave", hideTooltip )


</script>

</body>
</html>